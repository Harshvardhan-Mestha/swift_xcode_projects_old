//  ViewController.swift
//  Tetris
//
//  Created by Harshvardhan Mestha on 5/10/20.
//  Copyright Â© 2020 Harshvardhan Mestha. All rights reserved.
import UIKit

class ViewController: UIViewController {

    @IBOutlet weak var I1: UIImageView!
    @IBOutlet weak var I2: UIImageView!
    @IBOutlet weak var I3: UIImageView!
    @IBOutlet weak var I4: UIImageView!
    @IBOutlet weak var I5: UIImageView!
    @IBOutlet weak var I6: UIImageView!
    @IBOutlet weak var I7: UIImageView!
    @IBOutlet weak var I8: UIImageView!
    @IBOutlet weak var I9: UIImageView!
    @IBOutlet weak var I10: UIImageView!
    @IBOutlet weak var I11: UIImageView!
    @IBOutlet weak var I12: UIImageView!
    @IBOutlet weak var I13: UIImageView!
    @IBOutlet weak var I14: UIImageView!
    @IBOutlet weak var I15: UIImageView!
    @IBOutlet weak var I16: UIImageView!
    @IBOutlet weak var I17: UIImageView!
    @IBOutlet weak var I18: UIImageView!
    @IBOutlet weak var I19: UIImageView!
    @IBOutlet weak var I20: UIImageView!
    @IBOutlet weak var I21: UIImageView!
    @IBOutlet weak var I22: UIImageView!
    @IBOutlet weak var I23: UIImageView!
    @IBOutlet weak var I24: UIImageView!
    @IBOutlet weak var I25: UIImageView!
    @IBOutlet weak var I26: UIImageView!
    @IBOutlet weak var I27: UIImageView!
    @IBOutlet weak var I28: UIImageView!
    @IBOutlet weak var I29: UIImageView!
    @IBOutlet weak var I30: UIImageView!
    @IBOutlet weak var I31: UIImageView!
    @IBOutlet weak var I32: UIImageView!
    @IBOutlet weak var I33: UIImageView!
    @IBOutlet weak var I34: UIImageView!
    @IBOutlet weak var I35: UIImageView!
    @IBOutlet weak var I36: UIImageView!
    @IBOutlet weak var I37: UIImageView!
    @IBOutlet weak var I38: UIImageView!
    @IBOutlet weak var I39: UIImageView!
    @IBOutlet weak var I40: UIImageView!
    @IBOutlet weak var I41: UIImageView!
    @IBOutlet weak var I42: UIImageView!
    @IBOutlet weak var I43: UIImageView!
    @IBOutlet weak var I44: UIImageView!
    @IBOutlet weak var I45: UIImageView!
    @IBOutlet weak var I46: UIImageView!
    @IBOutlet weak var I47: UIImageView!
    @IBOutlet weak var I48: UIImageView!
    @IBOutlet weak var I49: UIImageView!
    @IBOutlet weak var I50: UIImageView!
    @IBOutlet weak var I51: UIImageView!
    @IBOutlet weak var I52: UIImageView!
    @IBOutlet weak var I53: UIImageView!
    @IBOutlet weak var I54: UIImageView!
    @IBOutlet weak var I55: UIImageView!
    @IBOutlet weak var I56: UIImageView!
    @IBOutlet weak var I57: UIImageView!
    @IBOutlet weak var I58: UIImageView!
    @IBOutlet weak var I59: UIImageView!
    @IBOutlet weak var I60: UIImageView!
    @IBOutlet weak var I61: UIImageView!
    @IBOutlet weak var I62: UIImageView!
    @IBOutlet weak var I63: UIImageView!
    @IBOutlet weak var I64: UIImageView!
    @IBOutlet weak var I65: UIImageView!
    @IBOutlet weak var I66: UIImageView!
    @IBOutlet weak var I67: UIImageView!
    @IBOutlet weak var I68: UIImageView!
    @IBOutlet weak var I69: UIImageView!
    @IBOutlet weak var I70: UIImageView!
    @IBOutlet weak var I71: UIImageView!
    @IBOutlet weak var I72: UIImageView!
    @IBOutlet weak var I73: UIImageView!
    @IBOutlet weak var I74: UIImageView!
    @IBOutlet weak var I75: UIImageView!
    @IBOutlet weak var I76: UIImageView!
    @IBOutlet weak var I77: UIImageView!
    @IBOutlet weak var I78: UIImageView!
    @IBOutlet weak var I79: UIImageView!
    @IBOutlet weak var I80: UIImageView!
    @IBOutlet weak var I81: UIImageView!
    @IBOutlet weak var I82: UIImageView!
    @IBOutlet weak var I83: UIImageView!
    @IBOutlet weak var I84: UIImageView!
    @IBOutlet weak var I85: UIImageView!
    @IBOutlet weak var I86: UIImageView!
    @IBOutlet weak var I87: UIImageView!
    @IBOutlet weak var I88: UIImageView!
    @IBOutlet weak var I89: UIImageView!
    @IBOutlet weak var I90: UIImageView!
    @IBOutlet weak var I91: UIImageView!
    @IBOutlet weak var I92: UIImageView!
    @IBOutlet weak var I93: UIImageView!
    @IBOutlet weak var I94: UIImageView!
    @IBOutlet weak var I95: UIImageView!
    @IBOutlet weak var I96: UIImageView!
    @IBOutlet weak var I97: UIImageView!
    @IBOutlet weak var I98: UIImageView!
    @IBOutlet weak var I99: UIImageView!
    @IBOutlet weak var I100: UIImageView!
    @IBOutlet weak var I101: UIImageView!
    @IBOutlet weak var I102: UIImageView!
    @IBOutlet weak var I103: UIImageView!
    @IBOutlet weak var I104: UIImageView!
    @IBOutlet weak var I105: UIImageView!
    @IBOutlet weak var I106: UIImageView!
    @IBOutlet weak var I107: UIImageView!
    @IBOutlet weak var I108: UIImageView!
    @IBOutlet weak var I109: UIImageView!
    @IBOutlet weak var I110: UIImageView!
    @IBOutlet weak var I111: UIImageView!
    @IBOutlet weak var I112: UIImageView!
    @IBOutlet weak var I113: UIImageView!
    @IBOutlet weak var I114: UIImageView!
    @IBOutlet weak var I115: UIImageView!
    @IBOutlet weak var I116: UIImageView!
    @IBOutlet weak var I117: UIImageView!
    @IBOutlet weak var I118: UIImageView!
    @IBOutlet weak var I119: UIImageView!
    @IBOutlet weak var I120: UIImageView!
    @IBOutlet weak var I121: UIImageView!
    @IBOutlet weak var I122: UIImageView!
    @IBOutlet weak var I123: UIImageView!
    @IBOutlet weak var I124: UIImageView!
    @IBOutlet weak var I125: UIImageView!
    @IBOutlet weak var I126: UIImageView!
    @IBOutlet weak var I127: UIImageView!
    @IBOutlet weak var I128: UIImageView!
    @IBOutlet weak var I129: UIImageView!
    @IBOutlet weak var I130: UIImageView!
    @IBOutlet weak var I131: UIImageView!
    @IBOutlet weak var I132: UIImageView!
    @IBOutlet weak var I133: UIImageView!
    @IBOutlet weak var I134: UIImageView!
    @IBOutlet weak var I135: UIImageView!
    @IBOutlet weak var I136: UIImageView!
    @IBOutlet weak var I137: UIImageView!
    @IBOutlet weak var I138: UIImageView!
    @IBOutlet weak var I139: UIImageView!
    @IBOutlet weak var I140: UIImageView!
    @IBOutlet weak var I141: UIImageView!
    @IBOutlet weak var I142: UIImageView!
    @IBOutlet weak var I143: UIImageView!
    @IBOutlet weak var I144: UIImageView!
    @IBOutlet weak var I145: UIImageView!
    @IBOutlet weak var I146: UIImageView!
    @IBOutlet weak var I147: UIImageView!
    @IBOutlet weak var I148: UIImageView!
    @IBOutlet weak var I149: UIImageView!
    @IBOutlet weak var I150: UIImageView!
    @IBOutlet weak var I151: UIImageView!
    @IBOutlet weak var I152: UIImageView!
    @IBOutlet weak var I153: UIImageView!
    @IBOutlet weak var I154: UIImageView!
    @IBOutlet weak var I155: UIImageView!
    @IBOutlet weak var I156: UIImageView!
    @IBOutlet weak var I157: UIImageView!
    @IBOutlet weak var I158: UIImageView!
    @IBOutlet weak var I159: UIImageView!
    @IBOutlet weak var I160: UIImageView!
    @IBOutlet weak var I161: UIImageView!
    @IBOutlet weak var I162: UIImageView!
    @IBOutlet weak var I163: UIImageView!
    @IBOutlet weak var I164: UIImageView!
    @IBOutlet weak var I165: UIImageView!
    @IBOutlet weak var I166: UIImageView!
    @IBOutlet weak var I167: UIImageView!
    @IBOutlet weak var I168: UIImageView!
    @IBOutlet weak var I169: UIImageView!
    @IBOutlet weak var I170: UIImageView!
    @IBOutlet weak var I171: UIImageView!
    @IBOutlet weak var I172: UIImageView!
    @IBOutlet weak var I173: UIImageView!
    @IBOutlet weak var I174: UIImageView!
    @IBOutlet weak var I175: UIImageView!
    @IBOutlet weak var I176: UIImageView!
    @IBOutlet weak var I177: UIImageView!
    @IBOutlet weak var I178: UIImageView!
    @IBOutlet weak var I179: UIImageView!
    @IBOutlet weak var I180: UIImageView!
    @IBOutlet weak var I181: UIImageView!
    @IBOutlet weak var I182: UIImageView!
    @IBOutlet weak var I183: UIImageView!
    @IBOutlet weak var I184: UIImageView!
    @IBOutlet weak var I185: UIImageView!
    @IBOutlet weak var I186: UIImageView!
    @IBOutlet weak var I187: UIImageView!
    @IBOutlet weak var I188: UIImageView!
    @IBOutlet weak var I189: UIImageView!
    @IBOutlet weak var I190: UIImageView!
    @IBOutlet weak var I191: UIImageView!
    @IBOutlet weak var I192: UIImageView!
    @IBOutlet weak var I193: UIImageView!
    @IBOutlet weak var I194: UIImageView!
    @IBOutlet weak var I195: UIImageView!
    @IBOutlet weak var I196: UIImageView!
    @IBOutlet weak var I197: UIImageView!
    @IBOutlet weak var I198: UIImageView!
    @IBOutlet weak var I199: UIImageView!
    @IBOutlet weak var I200: UIImageView!
    
    @IBOutlet weak var B2: UIButton!
    @IBOutlet weak var B3: UIButton!
    @IBOutlet weak var B4: UIButton!
    @IBOutlet weak var B5: UIImageView!
    @IBOutlet weak var score: UILabel!
    
    override func viewDidLoad() {
        super.viewDidLoad()
        // Do any additional setup after loading the view.
        let B5T = UITapGestureRecognizer(target: self, action: #selector(hold_btn))
        B5.addGestureRecognizer(B5T)
        initalise();reset_all();randomiser();render_block();render()
        Timer.scheduledTimer(timeInterval: 0.5, target: self, selector: #selector(grav_main), userInfo: nil, repeats: true)}
    
    var skeleton = Array(repeating: Array(repeating: 0, count: 20), count: 10)
    var x = 0;var y = 0
    var c = 0;var r = 0
    var t  = 0
    var rx = 0;var ry = 0
    var cx = 0;var cy = 0
    var fd = false
    var hld_mod = false
    var old = 0
    var piv_x = 5;var piv_y = 1
    var xe = 0;var ye = 0
    var r_state = 1
    var i = 0
    var xr = 0;var yr = 0
    var x_ct = 0;var y_ct = 0
    var xn = 0;var yn = 0
    var xp = 0;var yp = 0
    var xn1 = 0;var yn1 = 0
    var xgc = 0
    var tetr_mod = 7
    var lrd = false
    var swap = true
    var l_fnd = false;var r_fnd = false
    var ctr = 0
    var rmod = true
    var a = 1
    var r_ct = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
    var c_ct = [0,0,0,0,0,0,0,0,0,0]
    var loss = false

    
    func initalise(){
        while y_ct < 20 {
            while x_ct < 10 {
                skeleton[x_ct][y_ct] = 0
                x_ct = x_ct + 1}
            y_ct = y_ct + 1
            x_ct = 0}
        
    }
    
    @IBAction func b1(_ sender: Any) {
        var m = 0
        while m <= piv_y{
            grav_main()
            m = m + 1
        }
    }
    @IBAction func b2(_ sender: Any) {rotate();erase();render_block();render()}
    @IBAction func b3(_ sender: Any) {left();erase();render_block();render()}
    @IBAction func b4(_ sender: Any) {right();erase();render_block();render()}
    
    
    @objc func grav_main(){
        gravity()
        if lrd == false {gravity_cancel()}
        else{reset_all();render_block();render()}
        render()
        
    }

    
    @objc func hold_btn(){
       old_det()
        if hld_mod == false{
            B5.image = UIImage(named: "\(tetr_mod)t")
            erase()
            randomiser()
            reset_all()
            B5.isUserInteractionEnabled = false
        }
        
        if hld_mod == true{
            B5.image = UIImage(named: "\(tetr_mod)t")
            erase()
            tetr_mod = old;a = old
            reset_all()
            B5.isUserInteractionEnabled = false
        }
        
    }
    func old_det(){
        if B5.image == UIImage(named: "1t"){old = 1}
        if B5.image == UIImage(named: "2t"){old = 2}
        if B5.image == UIImage(named: "3t"){old = 3}
        if B5.image == UIImage(named: "4t"){old = 4}
        if B5.image == UIImage(named: "5t"){old = 5}
        if B5.image == UIImage(named: "6t"){old = 6}
        if B5.image == UIImage(named: "7t"){old = 7}
    }
    
    func render(){
        xr = 0
        yr = 0
        let imgs = [I1,I2,I3,I4,I5,I6,I7,I8,I9,I10,I11,I12,I13,I14,I15,I16,I17,I18,I19,I20,I21,I22,I23,I24,I25,I26,I27,I28,I29,I30,I31,I32,I33,I34,I35,I36,I37,I38,I39,I40,I41,I42,I43,I44,I45,I46,I47,I48,I49,I50,I51,I52,I53,I54,I55,I56,I57,I58,I59,I60,I61,I62,I63,I64,I65,I66,I67,I68,I69,I70,I71,I72,I73,I74,I75,I76,I77,I78,I79,I80,I81,I82,I83,I84,I85,I86,I87,I88,I89,I90,I91,I92,I93,I94,I95,I96,I97,I98,I99,I100,I101,I102,I103,I104,I105,I106,I107,I108,I109,I110,I111,I112,I113,I114,I115,I116,I117,I118,I119,I120,I121,I122,I123,I124,I125,I126,I127,I128,I129,I130,I131,I132,I133,I134,I135,I136,I137,I138,I139,I140,I141,I142,I143,I144,I145,I146,I147,I148,I149,I150,I151,I152,I153,I154,I155,I156,I157,I158,I159,I160,I161,I162,I163,I164,I165,I166,I167,I168,I169,I170,I171,I172,I173,I174,I175,I176,I177,I178,I179,I180,I181,I182,I183,I184,I185,I186,I187,I188,I189,I190,I191,I192,I193,I194,I195,I196,I197,I198,I199,I200]

    while yr < 20 {
        while xr < 10 {
            let ind = ((20 - (yr+1))*10) + (xr+1)
            imgs[ind-1]?.image = UIImage(named: "\(abs(skeleton[xr][yr]))")
               xr = xr + 1}
           yr = yr + 1
           xr = 0}
        
    }
        
    func randomiser(){
        a = Int(arc4random_uniform(7) + 1)
        tetr_mod = a
        
    }
    
    func render_block(){
    if tetr_mod == 1{
        if r_state%2 == 1 && piv_y <= 19{
            skeleton[piv_x - 2][piv_y] = 1
            skeleton[piv_x - 1][piv_y] = 1
            skeleton[piv_x][piv_y] = 1
            skeleton[piv_x + 1][piv_y] = 1}
        if r_state%2 == 0{
            skeleton[piv_x][piv_y + 2] = 1
            skeleton[piv_x][piv_y - 1] = 1
            skeleton[piv_x][piv_y] = 1
            skeleton[piv_x][piv_y + 1] = 1}}
    if tetr_mod == 2{
        if r_state == 1{
            skeleton[piv_x - 1][piv_y - 1] = 2
            skeleton[piv_x - 1][piv_y] = 2
            skeleton[piv_x][piv_y] = 2
            skeleton[piv_x + 1][piv_y] = 2}
        if r_state == 2{
             skeleton[piv_x + 1][piv_y - 1] = 2
             skeleton[piv_x][piv_y - 1] = 2
             skeleton[piv_x][piv_y] = 2
             skeleton[piv_x][piv_y + 1] = 2}
        if r_state == 3{
              skeleton[piv_x + 1][piv_y + 1] = 2
              skeleton[piv_x - 1][piv_y] = 2
              skeleton[piv_x][piv_y] = 2
              skeleton[piv_x + 1][piv_y] = 2}
        if r_state == 4{
              skeleton[piv_x - 1][piv_y + 1] = 2
              skeleton[piv_x][piv_y - 1] = 2
              skeleton[piv_x][piv_y] = 2
              skeleton[piv_x][piv_y + 1] = 2}}
    if tetr_mod == 3{
        if r_state == 1{
            skeleton[piv_x + 1][piv_y - 1] = 3
            skeleton[piv_x - 1][piv_y] = 3
            skeleton[piv_x][piv_y] = 3
            skeleton[piv_x + 1][piv_y] = 3}
        if r_state == 2{
             skeleton[piv_x + 1][piv_y + 1] = 3
             skeleton[piv_x][piv_y - 1] = 3
             skeleton[piv_x][piv_y] = 3
             skeleton[piv_x][piv_y + 1] = 3}
        if r_state == 3{
              skeleton[piv_x - 1][piv_y + 1] = 3
              skeleton[piv_x - 1][piv_y] = 3
              skeleton[piv_x][piv_y] = 3
              skeleton[piv_x + 1][piv_y] = 3}
        if r_state == 4{
              skeleton[piv_x - 1][piv_y - 1] = 3
              skeleton[piv_x][piv_y - 1] = 3
              skeleton[piv_x][piv_y] = 3
              skeleton[piv_x][piv_y + 1] = 3}}
    if tetr_mod == 4{
        if r_state >= 1{
            skeleton[piv_x][piv_y - 1] = 4
            skeleton[piv_x - 1][piv_y] = 4
            skeleton[piv_x][piv_y] = 4
            skeleton[piv_x - 1][piv_y - 1] = 4}}
    if tetr_mod == 5{
        if r_state == 1{
            skeleton[piv_x + 1][piv_y - 1] = 5
            skeleton[piv_x - 1][piv_y] = 5
            skeleton[piv_x][piv_y] = 5
            skeleton[piv_x][piv_y - 1] = 5}
        if r_state == 2{
             skeleton[piv_x + 1][piv_y + 1] = 5
             skeleton[piv_x][piv_y - 1] = 5
             skeleton[piv_x][piv_y] = 5
             skeleton[piv_x + 1][piv_y] = 5}
        if r_state == 3{
              skeleton[piv_x - 1][piv_y + 1] = 5
              skeleton[piv_x][piv_y + 1] = 5
              skeleton[piv_x][piv_y] = 5
              skeleton[piv_x + 1][piv_y] = 5}
        if r_state == 4{
              skeleton[piv_x - 1][piv_y - 1] = 5
              skeleton[piv_x - 1][piv_y] = 5
              skeleton[piv_x][piv_y] = 5
              skeleton[piv_x][piv_y + 1] = 5}}
    if tetr_mod == 6{
        if r_state == 1{
            skeleton[piv_x + 1][piv_y] = 6
            skeleton[piv_x - 1][piv_y] = 6
            skeleton[piv_x][piv_y] = 6
            skeleton[piv_x][piv_y - 1] = 6}
        if r_state == 2{
             skeleton[piv_x][piv_y + 1] = 6
             skeleton[piv_x][piv_y - 1] = 6
             skeleton[piv_x][piv_y] = 6
             skeleton[piv_x + 1][piv_y] = 6}
        if r_state == 3{
              skeleton[piv_x - 1][piv_y] = 6
              skeleton[piv_x][piv_y + 1] = 6
              skeleton[piv_x][piv_y] = 6
              skeleton[piv_x + 1][piv_y] = 6}
        if r_state == 4{
              skeleton[piv_x][piv_y - 1] = 6
              skeleton[piv_x - 1][piv_y] = 6
              skeleton[piv_x][piv_y] = 6
              skeleton[piv_x][piv_y + 1] = 6}}
    if tetr_mod == 7{
        if r_state == 1{
            skeleton[piv_x + 1][piv_y] = 7
            skeleton[piv_x - 1][piv_y - 1] = 7
            skeleton[piv_x][piv_y] = 7
            skeleton[piv_x][piv_y - 1] = 7}
        if r_state == 2{
             skeleton[piv_x][piv_y + 1] = 7
             skeleton[piv_x + 1][piv_y - 1] = 7
             skeleton[piv_x][piv_y] = 7
             skeleton[piv_x + 1][piv_y] = 7}
        if r_state == 3{
              skeleton[piv_x - 1][piv_y] = 7
              skeleton[piv_x][piv_y + 1] = 7
              skeleton[piv_x][piv_y] = 7
              skeleton[piv_x + 1][piv_y + 1] = 7}
        if r_state == 4{
              skeleton[piv_x][piv_y - 1] = 7
              skeleton[piv_x - 1][piv_y] = 7
              skeleton[piv_x][piv_y] = 7
              skeleton[piv_x - 1][piv_y + 1] = 7}}
        
    }
    
    func erase(){
        xe = 0
        ye = 0
        while ye < 19 {
        while xe < 10 {
            if skeleton[xe][ye] > 0 {skeleton[xe][ye] = 0}
               xe = xe + 1}
           ye = ye + 1
           xe = 0}
        render()
        
    }
    
    func gravity(){
        nuke()
        if swap == true{
        piv_y = piv_y + 1
        erase()
        render_block()
        rowfill()
        }
        else{hld_mod = true;B5.isUserInteractionEnabled = true;
            negate();push_pos();randomiser();reset_all();rowfill()}
        
    }
    
    func rowfill(){
        r_ct = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
        rx = 0
        ry = 0
        while ry < 20{
            while rx < 10{
                if skeleton[rx][ry] < 0{r_ct[ry] = r_ct[ry] + 1}
                rx = rx + 1}
            ry = ry + 1;rx = 0}
        delete_row()
        
    }
    
    func delete_row(){
        r = 0
        while r < r_ct.count{
            if r_ct[r] == 10{
                 var j = 0
                while j < 10{
                    skeleton[j][r] = 0;j = j + 1}
                push_neg()}
            r = r + 1}
        
    }
 
    func winmsg(title:String,message:String){
        let alert = UIAlertController(title: title, message: message, preferredStyle: UIAlertController.Style.alert)
        alert.addAction(UIAlertAction(title: "New Game", style: UIAlertAction.Style.default, handler: {(action) in self.initalise();self.reset_all();self.render()
            alert.dismiss(animated: true, completion: nil)
        }))
        self.present(alert,animated: true)
    }
    
    func gravity_cancel(){
        xgc = 0
        while xgc<10 {
            if skeleton[xgc][19] > 0{
                B2.isUserInteractionEnabled = false
                B3.isUserInteractionEnabled = false
                B4.isUserInteractionEnabled = false
                //swap = false
                skeleton[xgc][19] = abs(skeleton[xgc][19]) * -1
                lrd = true
                swap = false
            }
            xgc = xgc + 1}
        
    }
    
    func negate(){
        xn1 = 0
        yn1 = 0
        while yn1 < 19{
            while xn1 < 10{
                if skeleton[xn1][yn1] > 0{skeleton[xn1][yn1] = abs(skeleton[xn1][yn1]) * -1}
                xn1 = xn1 + 1}
            yn1 = yn1 + 1;xn1 = 0}
        
    }
    
    func push_pos(){
        xp = 0;yp = 0
        while yp < 19 {
        while xp < 10 {
            if skeleton[xp][yp] > 0 {
                var t1 = abs(skeleton[xp][yp]) * -1
                skeleton[xp][yp] = skeleton[xp][yp+1]
                skeleton[xp][yp+1] = t1}
           xp = xp + 1}
           yp = yp + 1
           xp = 0}
        
    }
    
    func push_neg(){
        xp = 0
        yp = 19
        while yp > 0 {
        while xp < 10 {
            if skeleton[xp][yp] < 0 {
                var t1 = abs(skeleton[xp][yp]) * -1
                skeleton[xp][yp] = skeleton[xp][yp+1]
                skeleton[xp][yp+1] = t1}
               xp = xp + 1}
           yp = yp - 1
           xp = 0}}
    
    func nuke(){
         xn = 0
         yn = 0
         while xn < 10 {
         while yn < 19 {
            if skeleton[xn][yn] > 0 && skeleton[xn][yn+1] < 0{
                if yn <= 2{winmsg(title: "You Lose !!!", message: "Git Gud")}
                swap = false}
          yn = yn + 1}
          xn = xn + 1;yn = 0}
        
    }
    
    func left(){
        x_ct = 0
        y_ct = 0
        var n = 0
        while x_ct < 10 {
        while y_ct < 20 {
            if skeleton[0][y_ct]>0{B3.isUserInteractionEnabled = false}
            else if skeleton[0][y_ct]<=0{B3.isUserInteractionEnabled = true}
            if skeleton[x_ct][y_ct]>0{//l_fnd = true;break
                if x_ct > 0{if skeleton[x_ct - 1][y_ct]<0{l_fnd = true}}
                if x_ct == 0{l_fnd = true}}
            y_ct = y_ct + 1}
        x_ct = x_ct + 1
        y_ct = 0}
        if l_fnd == false{piv_x = piv_x - 1;l_fnd = false}
        l_fnd = false
        
    }
    
    func right(){
        x_ct = 9
        y_ct = 0
        while x_ct >= 0 {
        while y_ct < 20 {
            if skeleton[9][y_ct]>0{B4.isUserInteractionEnabled = false}
            else if skeleton[9][y_ct]<=0{B4.isUserInteractionEnabled = true}
            if skeleton[x_ct][y_ct] > 0{
                if x_ct < 9{if skeleton[x_ct + 1][y_ct]<0{r_fnd = true}}
                if x_ct == 9{r_fnd = true}}
            y_ct = y_ct + 1}
        x_ct = x_ct - 1
        y_ct = 0}
        if r_fnd == false{piv_x = piv_x + 1;r_fnd = false}
        r_fnd = false}
    
    func rotate(){
        if piv_x == 9 || piv_x == 0{rmod = false}
        else{rmod = true}
        if rmod == true{
            if r_state <= 4 {r_state = r_state + 1}
            if r_state == 5{r_state = 1}
            
        }
        
    }
    
    func reset_all(){
        x = 0;y = 0
        r = 0
        rx = 0;ry = 0
        cx = 0;cy = 0
        fd = false
        piv_x = 5;piv_y = 1
        xe = 0;ye = 0
        r_state = 1
        i = 0
        xr = 0;yr = 0
        x_ct = 0;y_ct = 0
        xn = 0;yn = 0
        xp = 0;yp = 0
        xn1 = 0;yn1 = 0
        xgc = 0
        tetr_mod = a
        lrd = false
        swap = true
        l_fnd = false;r_fnd = false
        ctr = 0
        rmod = true
        a = 1
        r_ct = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
        c_ct = [0,0,0,0,0,0,0,0,0,0]
        loss = false
        B2.isUserInteractionEnabled = true
        B3.isUserInteractionEnabled = true
        B4.isUserInteractionEnabled = true
    }
    
}
//Completed Tetris in 666 lines.
//TODO:
//Pause Button
//Highscores
//Proper display on all devices
//Hold button bug fix
